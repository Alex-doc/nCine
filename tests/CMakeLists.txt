cmake_minimum_required(VERSION 2.8.12)
project(nCine-tests)

if(WIN32)
	add_custom_target(copy_dlls_tests ALL
		COMMAND ${CMAKE_COMMAND} -E copy_directory ${BINDIR} ${CMAKE_BINARY_DIR}/tests
		COMMENT "Copying DLLs to tests..."
	)
	set_target_properties(copy_dlls_tests PROPERTIES FOLDER "CustomCopyTargets")

	if(NCINE_DYNAMIC_LIBRARY)
		if(MSVC_IDE)
			add_custom_target(copy_ncine_dll ALL
				COMMAND ${CMAKE_COMMAND} -E copy_if_different ${CMAKE_BINARY_DIR}/$<CONFIGURATION>/ncine.dll ${CMAKE_BINARY_DIR}/tests
				DEPENDS ncine
				COMMENT "Copying nCine DLL..."
			)
		else()
			add_custom_target(copy_ncine_dll ALL
				COMMAND ${CMAKE_COMMAND} -E copy_if_different ${CMAKE_BINARY_DIR}/ncine.dll ${CMAKE_BINARY_DIR}/tests
				DEPENDS ncine
				COMMENT "Copying nCine DLL..."
			)
		endif()
		set_target_properties(copy_ncine_dll PROPERTIES FOLDER "CustomCopyTargets")
	endif()
endif()

if((SDLIMAGE_FOUND OR PNG_FOUND) AND WEBP_FOUND)
	add_executable(apptest_texformats main.cpp apptest_texformats.cpp)
	target_link_libraries(apptest_texformats ncine)
	add_executable(apptest_joystick main.cpp apptest_joystick.cpp)
	target_link_libraries(apptest_joystick ncine)
	add_executable(apptest_rotozoom main.cpp apptest_rotozoom.cpp)
	target_link_libraries(apptest_rotozoom ncine)
	add_executable(apptest_animsprites main.cpp apptest_animsprites.cpp)
	target_link_libraries(apptest_animsprites ncine)
	if(OPENAL_FOUND)
		add_executable(apptest_audio main.cpp apptest_audio.cpp)
		target_link_libraries(apptest_audio ncine)
		set_target_properties(apptest_audio PROPERTIES FOLDER "AppTests")
		install(TARGETS apptest_audio RUNTIME DESTINATION bin)
	endif()
	add_executable(apptest_particles main.cpp apptest_particles.cpp)
	target_link_libraries(apptest_particles ncine)
	add_executable(apptest_scene main.cpp apptest_scene.cpp)
	target_link_libraries(apptest_scene ncine)
	add_executable(apptest_font main.cpp apptest_font.cpp)
	target_link_libraries(apptest_font ncine)
	set_target_properties(apptest_texformats apptest_joystick apptest_rotozoom apptest_animsprites apptest_particles apptest_scene apptest_font PROPERTIES FOLDER "AppTests")
	install(TARGETS apptest_texformats apptest_joystick apptest_rotozoom apptest_animsprites apptest_particles apptest_scene apptest_font RUNTIME DESTINATION bin)
endif()

add_executable(test_array test_array.cpp test_functions.h)
target_link_libraries(test_array ncine)
add_executable(test_staticarray test_staticarray.cpp)
target_link_libraries(test_staticarray ncine)
add_executable(test_list test_list.cpp test_functions.h)
target_link_libraries(test_list ncine)
add_executable(test_string test_string.cpp)
target_link_libraries(test_string ncine)
add_executable(test_hashmap test_hashmap.cpp)
target_link_libraries(test_hashmap ncine)
add_executable(test2_hashmap test2_hashmap.cpp)
target_link_libraries(test2_hashmap ncine)
set_target_properties(test_array test_staticarray test_list test_string test_hashmap test2_hashmap test2_hashmap PROPERTIES FOLDER "Tests")
install(TARGETS test_array test_staticarray test_list test_string test_hashmap test2_hashmap test2_hashmap RUNTIME DESTINATION bin)

add_executable(test_algorithms_array test_algorithms_array.cpp test_functions.h)
target_link_libraries(test_algorithms_array ncine)
add_executable(test_algorithms_list test_algorithms_list.cpp test_functions.h)
target_link_libraries(test_algorithms_list ncine)
add_executable(test_algorithms_hashmap test_algorithms_hashmap.cpp test_functions.h)
target_link_libraries(test_algorithms_hashmap ncine)
set_target_properties(test_algorithms_array test_algorithms_list test_algorithms_hashmap PROPERTIES FOLDER "Tests")
install(TARGETS test_algorithms_array test_algorithms_list test_algorithms_hashmap RUNTIME DESTINATION bin)

add_executable(test_vector2 test_vector2.cpp)
target_link_libraries(test_vector2 ncine)
add_executable(test_vector3 test_vector3.cpp)
target_link_libraries(test_vector3 ncine)
add_executable(test_vector4 test_vector4.cpp)
target_link_libraries(test_vector4 ncine)
add_executable(test_matrix4x4 test_matrix4x4.cpp test_functions.h)
target_link_libraries(test_matrix4x4 ncine)
add_executable(test2_matrix4x4 test2_matrix4x4.cpp test_functions.h)
target_link_libraries(test2_matrix4x4 ncine)
add_executable(test_quaternion test_quaternion.cpp)
target_link_libraries(test_quaternion ncine)
add_executable(test2_quaternion test2_quaternion.cpp test_functions.h)
target_link_libraries(test2_quaternion ncine)
set_target_properties(test_vector2 test_vector3 test_vector4 test_matrix4x4 test2_matrix4x4 test_quaternion test2_quaternion PROPERTIES FOLDER "Tests")
install(TARGETS test_vector2 test_vector3 test_vector4 test_matrix4x4 test2_matrix4x4 test_quaternion test2_quaternion RUNTIME DESTINATION bin)
